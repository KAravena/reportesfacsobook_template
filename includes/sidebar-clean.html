<script>
document.addEventListener('DOMContentLoaded', () => {
  const cleanIndexLink = () => {
    let changed = false;
    const links = document.querySelectorAll(
      'a.sidebar-item-text[href*="index.html"]'
    );
    links.forEach((link) => {
      const menuText = link.querySelector('.menu-text');
      if (!menuText) {
        return;
      }

      const title = menuText.querySelector('.chapter-title');
      if (title) {
        if (title.previousSibling) {
          title.previousSibling.remove();
        }
        const chapterNumber = menuText.querySelector('.chapter-number');
        if (chapterNumber) {
          chapterNumber.remove();
        }
        menuText.innerHTML = '';
        menuText.appendChild(title);
        changed = true;
        return;
      }

      const chapterNumber = menuText.querySelector('.chapter-number');
      if (chapterNumber) {
        const sibling = chapterNumber.nextSibling;
        chapterNumber.remove();
        if (sibling && sibling.nodeType === Node.TEXT_NODE) {
          sibling.remove();
        }
        menuText.textContent = menuText.textContent.trim();
        changed = true;
      }
    });
    return changed;
  };

  const ensureClean = () => {
    if (cleanIndexLink()) {
      return;
    }
    const observer = new MutationObserver(() => {
      if (cleanIndexLink()) {
        observer.disconnect();
      }
    });
    observer.observe(document.body, {
      childList: true,
      subtree: true,
    });
  };

  ensureClean();
  document.addEventListener('quarto:navChanged', ensureClean);
});
</script>
